import Utilities as U
import Exploiter as E
import argparse
import re
import numpy as np

ap = argparse.ArgumentParser()
ap.add_argument("-o", "--output", default = 'output - leduc3.txt')
ap.add_argument("-i", "--game", default = 'input - leduc3.txt')

args = vars(ap.parse_args())
print(args)

gamestatus = dict()

restrat = "(?<=strategies\s)(.*)$"
remove = "(?<=\=)(.*)"
rehist = "(?<=infoset\s)(.*?)(?=\\sstrategies)"
renode = "(?<=node\s)(.*?)(?=\s)"
reactions = "(?<=actions\s)(.*)"
repayoff = "(?<=payoffs\s)(.*)"
replayer = "(?<=player\s)[1-2]{1}"

with open(args['player1']) as p1:
    line = p1.readline()
    while line:
        matchist = re.search(rehist, line)
        match = re.search(restrat, line)
        strats = match.group(1)
        moves = strats.split(' ')
        gamestatus.update({matchist.group(1) : {p:{'actions': [move.split('=')[0] for move in moves], 'odds': [float(move.split('=')[1]) for move in moves]} for p in ['P1','P2']}})
        line = p1.readline()
    p1.close()

with open(args['player2']) as p2:
    line = p2.readline()
    while line:
        matchist = re.search(rehist, line)
        match = re.search(restrat, line)
        strats = match.group(1)
        moves = strats.split(' ')
        for move in moves:
            gamestatus[matchist.group(1)]['P2'][move.split('=')[0]] = float(move.split('=')[1])
        line = p2.readline()
    p2.close()
